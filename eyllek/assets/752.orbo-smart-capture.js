/*! For license information please see 752.orbo-smart-capture.js.LICENSE.txt */
(self.webpackChunkOrboSmartCapture=self.webpackChunkOrboSmartCapture||[]).push([[752],{1752:(t,e,n)=>{"use strict";n.r(e),n.d(e,{captureSelfie:()=>me,cropAndValidateFace:()=>we,getTF:()=>u.Vu,stop:()=>pe,version:()=>ye,withConfig:()=>be});var r=n(5608),a=n(9392),i=n.n(a),o=n(159),u=n(5777);let c,s;const l=`${r.T.STATIC_ASSETS_BASE_URL}wasm-store/tf/`;let f,d,h,v,_,g,m,p,y,w,b=null,E=!0;const S=async t=>{const e=await(0,u.sO)(),n=await e.estimateFaces(t,!1,!1,!1);return n&&0!==n.length?n[0]:null},A=async(t,e)=>{s||await R();const n=parseInt(e.topLeft[0]),r=parseInt(e.topLeft[1]),a=parseInt(e.bottomRight[0]),i=parseInt(e.bottomRight[1]),o=await(0,u.Vu)(),l=await o.tidy(()=>{const e=o.div(t,255).slice([r,n],[i-r,a-n]),u=o.image.resizeBilinear(e,[112,112]).expandDims(0);let c=s.predict(u).squeeze(0).reshape([106,2]),[l,f]=o.split(c,2,1);return l=o.add(o.mul(l,e.shape[1]),n).asType("float32"),f=o.add(o.mul(f,e.shape[0]),r).asType("float32"),new Float32Array(o.concat([l,f],1).reshape([106,2]).dataSync().buffer)}),f=c._malloc(l.length*l.BYTES_PER_ELEMENT);c.HEAPF32.set(l,f>>2);const d=new Float32Array(c.glCalculateExtraFacePoints(f));return c._free(f),d},C=(t,e,n,r,a,i)=>{if(!c)throw new Error("WASM module not initialized");const u=c._malloc(t.length),s=c._malloc(e.length*e.BYTES_PER_ELEMENT);try{c.HEAPU8.set(t,u),c.HEAPF32.set(e,s>>2);const l=c.verify_image(u,n,r,s,a.tx,a.ty,a.bx,a.by,o.Fr,i);return{faceFound:!0,far:l.too_far,close:l.too_close,noSufficientLite:l.light,misAligned:!0===l.orientation,outsideGuide:l.outsideGuide}}catch(t){throw console.error("Error in validateWithWasm:",t),t}finally{c&&(u&&c._free(u),s&&c._free(s))}},T=(t,e,n)=>{const r=parseInt(t.topLeft[0]),a=parseInt(t.topLeft[1]),i=parseInt(t.bottomRight[0]),o=parseInt(t.bottomRight[1]);return!(r<=0||i>=e||a<=0||o>=n)},I=async t=>{performance.now();const e=await(0,u.Vu)();e.engine().startScope();try{const n=e.browser.fromPixels(t),r=await S(n);if(!r)return{faceFound:!1,far:!1,close:!1,noSufficientLite:!1,misAligned:!1,outsideGuide:!1};if(!T(r,m,g))return{faceFound:!1,far:!1,close:!1,noSufficientLite:!1,misAligned:!1,outsideGuide:!1};const a=await A(n,r),i=await C(t.data,a,m,g,_,!1);return performance.now(),i}finally{e.engine().endScope()}},F=async()=>{if(E)return;y.drawImage(p,0,0),h.drawImage(p,w.x,w.y,w.width,w.height,0,0,m,g);const t=await I(h.getImageData(0,0,m,g));E||(v(t),requestAnimationFrame(F))},O=function(){return d||(d=new Promise((t,e)=>{P().then(()=>async function(){await D()}()).then(()=>{t()}).catch(()=>{d=null,e()})}),d)};let D=async()=>{s||await Promise.all([R()]).then(([t])=>(s=t,Promise.resolve()))};const P=async function(){return new Promise(async(t,e)=>{try{const e=await(0,u.Vu)();return await(0,u.sO)(),await(0,u.hA)(l),await e.setBackend("wasm"),await e.ready(),c={onRuntimeInitialized:()=>t(),onStatus:t=>{},onExit:()=>{},locateFile:t=>r.T.ASSETS_BASE_URL+t},e.enableProdMode(),i()(c)}catch(t){console.error("Error initializing WASM:",t),e(t)}})},R=async()=>{if(s)return s;try{const t=await(0,u.Vu)(),e=`${r.T.STATIC_ASSETS_BASE_URL}wasm-store/landmarks/112/`,n=`${e}landmarks-model.json`,a=`${e}landmark-weights.bin`,[i,o]=await Promise.all([fetch(n),fetch(a)]);if(!i.ok)throw new Error(`Failed to load model schema: ${i.statusText}`);if(!o.ok)throw new Error(`Failed to load model weights: ${o.statusText}`);const[c,l]=await Promise.all([i.json(),o.arrayBuffer()]),f=t.io.fromMemory({modelTopology:c.modelTopology,weightSpecs:c.weightsManifest,weightData:l,userDefinedMetadata:c.userDefinedMetaData||{}});return s=await t.loadGraphModel(f),s}catch(t){throw console.error("Error loading landmark model:",t),s=null,t}},k=()=>{E=!0};class x{static CONTAINER_MISSING={code:1,message:"Container is missing."};static SDK_NOT_INITIALIZED={code:2,message:"SDK not initialized."};static IMAGE_NOT_PROVIDED={code:3,message:"Image not provided."};static API_ERROR={code:4,message:"API error."};static CAMERA_NOT_FOUND={code:5,message:"Camera not found."};static APP_INIT_ISSUE={code:6,message:"App initialization issue."};static REQUEST_CANCELLED={code:7,message:"Request cancelled."};static IMAGE_FILE_MISSING={code:8,message:"Image file is missing."};static NO_FACE_DETECTED={code:9,message:"No face detected in the image."};static IMAGE_PROCESSING_FAILED={code:10,message:"Failed to process the image."}}var M=n(9035),U=n(1701);class L{static getMaxCenteredRectangle(t,e,n,r,a){let i=n,o=i/a;return o>r&&(o=r,i=o*a),i>t&&(i=t,o=i/a),o>e&&(o=e,i=o*a),{width:i,height:o,x:(t-i)/2,y:(e-o)/2}}}const N={GUIDELINE1:"Ensure your face is well lit from the front.",GUIDELINE2:"Remove any glasses, masks, or headwear.",GUIDELINE3:"Maintain a neutral expression and look straight at the camera.",GUIDELINE4:"Keep your hair tied back so your face is unobstructed.",GUIDELINE5:"Remain still during capture to avoid blurring."},W="Move a little closer!",j="Gently tilt your head back a bit.",Y="Make sure your face is evenly lit.",G="Keep your face straight and centered.",B="Lighting",z="Pose",H="Position",V="Align your face inside the oval.",q="PROCEED",$="RETRY",X="I Understand",K=class{#t;#e;constructor(t=10){this.#t=t,this.#e=0}setStatus(t){t?this.#e<this.#t&&this.#e++:this.#e>0&&this.#e--}getCount(){return this.#e}getWindowSize(){return this.#t}};function J(t){return J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},J(t)}var Z,Q=(0,M.vs)("<div class=osc-guidelines-container><div class=osc-guidelines><span>For best results:</span><span></span><span></span><span></span><span></span><span></span><button class=osc-button type=button>"),tt=(0,M.vs)('<div class="osc-abs-center osc-counter"id=autoCapturePendingInterval>'),et=(0,M.vs)("<div><div id=smart-capture-sdk><video class=osc-video autoplay=true id=selfieVideo muted playsinline></video><canvas class=osc-canvas id=previewCanvas></canvas><canvas class=osc-canvas id=validationCanvas style=display:none;></canvas><div><div class=osc-error-messages id=errorMessages><div></div><div></div><div></div><div></div><div></div></div></div><div class=osc-indicators><label></label><label></label><label></label></div><div class=osc-actions><button class=osc-button type=button></button><button class=osc-button type=button>");function nt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,a,i,o,u=[],c=!0,s=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(u.push(r.value),u.length!==e);c=!0);}catch(t){s=!0,a=t}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(s)throw a}}return u}}(t,e)||function(t,e){if(t){if("string"==typeof t)return rt(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?rt(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function rt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function at(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function i(n,r,a,i){var c=r&&r.prototype instanceof u?r:u,s=Object.create(c.prototype);return it(s,"_invoke",function(n,r,a){var i,u,c,s=0,l=a||[],f=!1,d={p:0,n:0,v:t,a:h,f:h.bind(t,4),d:function(e,n){return i=e,u=0,c=t,d.n=n,o}};function h(n,r){for(u=n,c=r,e=0;!f&&s&&!a&&e<l.length;e++){var a,i=l[e],h=d.p,v=i[2];n>3?(a=v===r)&&(c=i[(u=i[4])?5:(u=3,3)],i[4]=i[5]=t):i[0]<=h&&((a=n<2&&h<i[1])?(u=0,d.v=r,d.n=i[1]):h<v&&(a=n<3||i[0]>r||r>v)&&(i[4]=n,i[5]=r,d.n=v,u=0))}if(a||n>1)return o;throw f=!0,r}return function(a,l,v){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,v),u=l,c=v;(e=u<2?t:c)||!f;){i||(u?u<3?(u>1&&(d.n=-1),h(u,c)):d.n=c:d.v=c);try{if(s=2,i){if(u||(a="next"),e=i[a]){if(!(e=e.call(i,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,u<2&&(u=0)}else 1===u&&(e=i.return)&&e.call(i),u<2&&(c=TypeError("The iterator does not provide a '"+a+"' method"),u=1);i=t}else if((e=(f=d.n<0)?c:n.call(r,d))!==o)break}catch(e){i=t,u=1,c=e}finally{s=1}}return{value:e,done:f}}}(n,a,i),!0),s}var o={};function u(){}function c(){}function s(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(it(e={},r,function(){return this}),e),f=s.prototype=u.prototype=Object.create(l);function d(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,s):(t.__proto__=s,it(t,a,"GeneratorFunction")),t.prototype=Object.create(f),t}return c.prototype=s,it(f,"constructor",s),it(s,"constructor",c),c.displayName="GeneratorFunction",it(s,a,"GeneratorFunction"),it(f),it(f,a,"Generator"),it(f,r,function(){return this}),it(f,"toString",function(){return"[object Generator]"}),(at=function(){return{w:i,m:d}})()}function it(t,e,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(t){a=0}it=function(t,e,n,r){if(e)a?a(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var i=function(e,n){it(t,e,function(t){return this._invoke(e,n,t)})};i("next",0),i("throw",1),i("return",2)}},it(t,e,n,r)}function ot(t,e,n,r,a,i,o){try{var u=t[i](o),c=u.value}catch(t){return void n(t)}u.done?e(c):Promise.resolve(c).then(r,a)}function ut(t){return function(){var e=this,n=arguments;return new Promise(function(r,a){var i=t.apply(e,n);function o(t){ot(i,r,a,o,u,"next",t)}function u(t){ot(i,r,a,o,u,"throw",t)}o(void 0)})}}function ct(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,lt(r.key),r)}}function st(t,e,n){return(e=lt(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lt(t){var e=function(t){if("object"!=J(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=J(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==J(e)?e:e+""}function ft(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var dt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return e=t,n=[{key:"renderSmartCaptureUI",value:(r=ut(at().m(function e(n){var r;return at().w(function(e){for(;;)switch(e.n){case 0:if(!vt._){e.n=1;break}return e.a(2);case 1:return ht.call(t),e.p=2,e.n=3,navigator.mediaDevices.getUserMedia(_t._);case 3:r=e.v,gt._=r,vt._=(0,M.XX)(function(){return oe._.call(t)},n),fe._.call(t),e.n=6;break;case 4:return e.p=4,e.v,de._.notification(x.CAMERA_NOT_FOUND),e.n=5,Promise.reject(x.CAMERA_NOT_FOUND);case 5:return e.a(2,e.v);case 6:return e.a(2)}},e,null,[[2,4]])})),function(t){return r.apply(this,arguments)})}],n&&ct(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,n,r}();function ht(){Zt._.call(Z,3),zt._.call(Z,!1),Gt._.call(Z,!1),jt._.call(Z,!1),Vt._.call(Z,!0),$t._.call(Z,!0),Dt._.call(Z,!1),Nt._.call(Z,!1),Rt._.call(Z,!1),xt._.call(Z,!1),ne._.call(Z,0),Ut._.call(Z,!1),Kt._.call(Z,!1),te._.call(Z,!1),Z.capturedPic=null,ae._.call(Z,!0)}Z=dt;var vt={_:void 0},_t={_:{audio:!1,video:{facingMode:"user",width:{min:1280},height:{min:720}}}},gt={_:void 0},mt={_:void 0},pt={_:0},yt={_:0},wt={_:0},bt={_:0},Et={_:void 0},St={_:null},At={_:void 0},Ct={_:void 0},Tt={_:null},It={_:!1},Ft={_:0},Ot={_:void 0},Dt={_:void 0},Pt={_:void 0},Rt={_:void 0},kt={_:void 0},xt={_:void 0},Mt={_:void 0},Ut={_:void 0},Lt={_:void 0},Nt={_:void 0},Wt={_:void 0},jt={_:void 0},Yt={_:void 0},Gt={_:void 0},Bt={_:void 0},zt={_:void 0},Ht={_:void 0},Vt={_:void 0},qt={_:void 0},$t={_:void 0},Xt={_:void 0},Kt={_:void 0},Jt={_:void 0},Zt={_:void 0},Qt={_:void 0},te={_:void 0},ee={_:void 0},ne={_:void 0},re={_:void 0},ae={_:void 0};st(dt,"capturedPic",null),function(){var t=nt((0,U.n5)(!0),2);Ot._=t[0],Dt._=t[1];var e=nt((0,U.n5)(!0),2);Pt._=e[0],Rt._=e[1];var n=nt((0,U.n5)(!0),2);kt._=n[0],xt._=n[1];var r=nt((0,U.n5)(!1),2);Mt._=r[0],Ut._=r[1];var a=nt((0,U.n5)(!1),2);Lt._=a[0],Nt._=a[1];var i=nt((0,U.n5)(!1),2);Wt._=i[0],jt._=i[1];var o=nt((0,U.n5)(!1),2);Yt._=o[0],Gt._=o[1];var u=nt((0,U.n5)(!1),2);Bt._=u[0],zt._=u[1];var c=nt((0,U.n5)(!0),2);Ht._=c[0],Vt._=c[1];var s=nt((0,U.n5)(!1),2);qt._=s[0],$t._=s[1];var l=nt((0,U.n5)(!1),2);Xt._=l[0],Kt._=l[1];var f=nt((0,U.n5)(3),2);Jt._=f[0],Zt._=f[1];var d=nt((0,U.n5)(0),2);ee._=d[0],ne._=d[1];var h=nt((0,U.n5)(!1),2);Qt._=h[0],te._=h[1];var v=nt((0,U.n5)(!0),2);re._=v[0],ae._=v[1]}();var ie,oe={_:function(){return function(){var t=et(),e=t.firstChild,n=e.firstChild,r=n.nextSibling,a=r.nextSibling,i=a.nextSibling,o=i.firstChild.firstChild,u=o.nextSibling,c=u.nextSibling,s=c.nextSibling,l=s.nextSibling,f=i.nextSibling,d=f.firstChild,h=d.nextSibling,v=h.nextSibling,_=f.nextSibling.firstChild,g=_.nextSibling;(0,M.Yr)(e,(0,U.a0)(U.wv,{get when(){return re._.call(Z)},get children(){var t=Q(),e=t.firstChild.firstChild.nextSibling,n=e.nextSibling,r=n.nextSibling,a=r.nextSibling,i=a.nextSibling,o=i.nextSibling;return(0,M.Yr)(e,function(){return N.GUIDELINE1}),(0,M.Yr)(n,function(){return N.GUIDELINE2}),(0,M.Yr)(r,function(){return N.GUIDELINE3}),(0,M.Yr)(a,function(){return N.GUIDELINE4}),(0,M.Yr)(i,function(){return N.GUIDELINE5}),o.$$click=function(){return ae._.call(Z,!1)},(0,M.Yr)(o,function(){return X}),t}}),n);var m=mt._;"function"==typeof m?(0,M.Yx)(m,n):mt._=n;var p=Et._;"function"==typeof p?(0,M.Yx)(p,r):Et._=r;var y=Ct._;return"function"==typeof y?(0,M.Yx)(y,a):Ct._=a,(0,M.Yr)(o,function(){return W}),(0,M.Yr)(u,function(){return j}),(0,M.Yr)(c,function(){return Y}),(0,M.Yr)(s,function(){return G}),(0,M.Yr)(l,function(){return V}),(0,M.Yr)(e,(0,U.a0)(U.wv,{get when(){return Xt._.call(Z)},get children(){var t=tt();return(0,M.Yr)(t,function(){return Jt._.call(Z)||""}),t}}),f),(0,M.Yr)(d,function(){return B}),(0,M.Yr)(h,function(){return z}),(0,M.Yr)(v,function(){return H}),(0,M.q2)(_,"click",ue._,!0),(0,M.Yr)(_,function(){return $}),(0,M.q2)(g,"click",ce._,!0),(0,M.Yr)(g,function(){return q}),(0,U.gb)(function(n){var r="".concat(Qt._.call(Z)?"":"osc-veiled"," osc-smart-capture-container"),a="osc-smart-capture-sdk ".concat(0===ee._.call(Z)?"osc-capture-mode":"osc-review-mode"),f="osc-overlay-border osc-center osc-guidance-ellipse osc-abs-center ".concat(Ht._.call(Z)?"osc-valid-borde  r":"osc-invalid-border"),_="osc-div ".concat(Mt._.call(Z)?"osc-active":""),g="osc-div ".concat(Lt._.call(Z)?"osc-active":""),m="osc-div ".concat(Wt._.call(Z)?"osc-active":""),p="osc-div ".concat(Yt._.call(Z)?"osc-active":""),y="osc-div ".concat(Bt._.call(Z)?"osc-active":""),w="osc-label ".concat(Ot._.call(Z)?"osc-invalid":""),b="osc-label ".concat(Pt._.call(Z)?"osc-invalid":""),E="osc-label ".concat(kt._.call(Z)?"osc-invalid":"");return r!==n.e&&(0,M.s7)(t,n.e=r),a!==n.t&&(0,M.s7)(e,n.t=a),f!==n.a&&(0,M.s7)(i,n.a=f),_!==n.o&&(0,M.s7)(o,n.o=_),g!==n.i&&(0,M.s7)(u,n.i=g),m!==n.n&&(0,M.s7)(c,n.n=m),p!==n.s&&(0,M.s7)(s,n.s=p),y!==n.h&&(0,M.s7)(l,n.h=y),w!==n.r&&(0,M.s7)(d,n.r=w),b!==n.d&&(0,M.s7)(h,n.d=b),E!==n.l&&(0,M.s7)(v,n.l=E),n},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0}),t}()}},ue={_:(ie=ut(at().m(function t(){var e;return at().w(function(t){for(;;)switch(t.n){case 0:return It._=!1,ne._.call(Z,0),t.p=1,t.n=2,navigator.mediaDevices.getUserMedia(_t._);case 2:e=t.v,gt._=e,t.n=4;break;case 3:throw t.p=3,t.v,de._.notification(x.CAMERA_NOT_FOUND),new Error(x.CAMERA_NOT_FOUND);case 4:fe._.call(Z);case 5:return t.a(2)}},t,null,[[1,3]])})),function(){return ie.apply(this,arguments)})},ce={_:function(){ne._.call(Z,2);var t=document.createElement("canvas");t.width=At._.width,t.height=At._.height,t.getContext("2d").drawImage(Et._,At._.x,At._.y,At._.width,At._.height,0,0,At._.width,At._.height),t.toBlob(function(t){Z.capturedPic=t,de._.autoCaptureCallback(t)})}},se={_:0},le={_:new class{#n;#r;#a;constructor(t=1,e=1){this.#n={faceFound:new K(t),outsideGuide:new K(t),far:new K(t),close:new K(t),misAligned:new K(t),noSufficientLite:new K(t)},this.#r=["faceFound","outsideGuide","far","close","misAligned","noSufficientLite"],this.#a=e}updateStatus(t){this.#n.faceFound.setStatus(!t.faceFound),this.#n.outsideGuide.setStatus(t.outsideGuide),this.#n.far.setStatus(t.far),this.#n.close.setStatus(t.close),this.#n.misAligned.setStatus(t.misAligned),this.#n.noSufficientLite.setStatus(t.noSufficientLite)}getStatusCount(t){if(this.#n[t])return this.#n[t].getCount();throw new Error(`Invalid status type: ${t}`)}getValidationError(){for(const t of this.#r)if(this.#n[t].getCount()>=this.#a)return t;return null}}},fe={_:function(){St._&&St._.clearRect(0,0,Et._.width,Et._.height),Tt._&&Tt._.clearRect(0,0,Ct._.width,Ct._.height),mt._.srcObject=gt._,mt._.play();var t=function(){var e=mt._,n=e.videoWidth,r=e.videoHeight,a=r/.7,i=n/.7;At._=L.getMaxCenteredRectangle(n,r,i,a,.75),wt._=210,bt._=4*wt._/3,pt._=(300-wt._)/2,yt._=(400-bt._)/2,St._=Et._.getContext("2d",{alpha:!1,willReadFrequently:!0}),Tt._=Ct._.getContext("2d",{alpha:!1,desynchronized:!0,willReadFrequently:!0}),Et._.width=n,Et._.height=r,St._.translate(n,0),St._.scale(-1,1),Tt._.translate(n,0),Tt._.scale(-1,1),Ct._.width=300,Ct._.height=400,mt._.removeEventListener("loadeddata",t),O().then(function(){var t,e,n,r,a,i;t=mt._,e=Et._,n=Ct._,r=At._,a=function(t){var e;se._=ft(Z,Z,(e=ft(Z,Z,se)._,++e));var n=t.faceFound&&!t.far&&!t.close&&!t.noSufficientLite&&!t.misAligned&&!t.outsideGuide;ft(Z,Z,$t)._.call(Z,n),ft(Z,Z,le)._.updateStatus(t),ft(Z,Z,Vt)._.call(Z,null===ft(Z,Z,le)._.getValidationError()),It._!==Ht._.call(Z)&&(It._=Ht._.call(Z),Ht._.call(Z)?setTimeout(function(){Ht._.call(Z)&&(Zt._.call(Z,3),Kt._.call(Z,!0),Ft._&&(clearInterval(Ft._),Ft._=0),Ft._=setInterval(function(){Ht._.call(Z)||(clearInterval(Ft._),Ft._=0),Jt._.call(Z)>1&&(Zt._.call(Z,Jt._.call(Z)-1),1===Jt._.call(Z)&&setTimeout(function(){Ht._.call(Z)&&(async()=>{const t=h.getImageData(0,0,m,g);return await I(t)})()&&(he._.call(Z),Kt._.call(Z,!1),ne._.call(Z,1)),clearInterval(Ft._),Ft._=0},250))},1e3))},500):(clearInterval(Ft._),Ft._=0,Zt._.call(Z,3),Kt._.call(Z,!1)));var r=ft(Z,Z,le)._.getStatusCount("noSufficientLite")>=5,a=ft(Z,Z,le)._.getStatusCount("outsideGuide")>=5||ft(Z,Z,le)._.getStatusCount("far")>=5||ft(Z,Z,le)._.getStatusCount("close")>=5,i=ft(Z,Z,le)._.getStatusCount("misAligned")>=5,o=!1,u=!1,c=!1,s=!1,l=!1;switch(ft(Z,Z,le)._.getValidationError()){case"noSufficientLite":c=!0,r=!0;break;case"outsideGuide":l=!0,a=!0;break;case"far":o=!0,a=!0;break;case"close":u=!0,a=!0;break;case"misAligned":s=!0,i=!0;break;case"faceFound":l=!0,r=!0,i=!0,a=!0}ft(Z,Z,Ut)._.call(Z,o),ft(Z,Z,Nt)._.call(Z,u),ft(Z,Z,jt)._.call(Z,c),ft(Z,Z,Gt)._.call(Z,s),ft(Z,Z,zt)._.call(Z,l),ft(Z,Z,Dt)._.call(Z,r),ft(Z,Z,Rt)._.call(Z,i),ft(Z,Z,xt)._.call(Z,a)},i={tx:pt._,ty:yt._,bx:pt._+wt._,by:yt._+bt._},y=e.getContext("2d"),p=t,w=r,v=a,_=i,m=n.width,g=n.height,h=n.getContext("2d"),E=!1,requestAnimationFrame(F),te._.call(Z,!0)})};mt._.addEventListener("loadeddata",t)}},de={_:{autoCaptureCallback:function(){},notification:function(){}}},he={_:function(){k(),gt._&&gt._.getTracks().forEach(function(t){return t.stop()}),gt._=null,clearInterval(Ft._)}};st(dt,"addEventListener",function(t,e){switch(t){case"autoCapture":de._.autoCaptureCallback=e;break;case"notification":de._.notification=e}});var ve={_:function(t){switch(t){case"autoCapture":de._.autoCaptureCallback=function(){};break;case"notification":de._.notification=function(){}}}};st(dt,"stopSmartCaptureUI",function(){var t;he._.call(Z),vt._&&vt._.call(Z),null===(t=document.getElementById("otfs-smart-capture-cntr"))||void 0===t||t.remove(),vt._=void 0,ht.call(Z),ve._.call(Z)}),(0,M.z_)(["click"]);var _e=n(4357);let ge=null;const me=async t=>ge||(ge=new Promise(async(e,n)=>{if(!t)return n(x.CONTAINER_MISSING);try{dt.addEventListener("autoCapture",async t=>{try{pe(),e(t)}catch(t){pe(),n(t)}}),await O(),await dt.renderSmartCaptureUI(t)}catch(t){ge=null,console.error(t),pe(),n(t)}}),ge),pe=()=>{ge=null,dt.stopSmartCaptureUI(),(async()=>{k();try{(0,u.tP)()}catch(t){console.error("Error disposing TensorFlow.js resources:",t)}if(null!==b&&c&&(c._free(b),b=null),null!==f&&c&&(c._free(f),f=null),s){try{s.dispose()}catch(t){console.error("Error disposing landmark model:",t)}s=null}c&&(c=null),d&&(d=null),h=void 0,v=void 0,_=void 0,g=void 0,m=void 0,p=void 0,y=void 0,w=void 0})()},ye=()=>r.T.VERSION,we=async t=>{const e=[];if(!t)return{image:null,errors:["NO_IMAGE"]};try{await O();const n=new Image,r=URL.createObjectURL(t);await new Promise((t,a)=>{n.onload=()=>{if(n.width<500||n.height<500)return e.push("LOW_RESOLUTION"),void a(new Error("LOW_RESOLUTION"));t()},n.onerror=()=>{e.push("IMAGE_LOAD_ERROR"),a(new Error("Failed to load image"))},n.src=r});const a=await(async t=>(await(0,u.Vu)()).browser.fromPixels(t))(n),i=await S(a);if(!i)return e.push("NO_FACE_FOUND"),{image:null,errors:[...new Set(e)]};if(!T(i,n.naturalWidth,n.naturalHeight))return e.push("FACE_OUT_OF_BOUNDS"),{image:null,errors:[...new Set(e)]};const o=await A(a,i),c=[];for(let t=0;t<o.length;t+=2)c.push([o[t],o[t+1]]);if(URL.revokeObjectURL(r),a.dispose(),function(t,e,n){const r=.9*e,a=.9*n;for(let e=0;e<t.length;e++){const n=t[e][0],i=t[e][1];if(n<=0||n>=r||i<=0||i>=a)return!0}return!1}(c,n.naturalWidth,n.naturalHeight))return e.push("FACE_CLIPPED"),{image:null,errors:[...new Set(e)]};const s=await(0,_e.resizeImage)(t,c,500,667);if(0!==s.status)return e.push("RESIZE_ERROR"),{image:null,errors:[...new Set(e)]};const l={tx:0,ty:0,bx:500,by:667},f=new Float32Array(s.landmarks.flat()),d=C(s.imageData.data,f,500,667,l,!0);return d.faceFound||e.push("NO_FACE_FOUND"),d.noSufficientLite&&e.push("INSUFFICIENT_LIGHT"),d.misAligned&&e.push("FACE_MISALIGNED"),d.close&&e.push("FACE_TOO_CLOSE"),d.outsideGuide&&e.push("FACE_OUTSIDE_GUIDE"),{image:0===e.length?s.image:null,errors:[...new Set(e)]}}catch(t){return console.error("Error in cropFace:",t),0===e.length&&e.push("UNKNOWN_ERROR"),{image:null,errors:[...new Set(e)]}}},be=t=>{r.T.STATIC_ASSETS_BASE_URL=t.STATIC_ASSETS_BASE_URL,r.T.ASSETS_BASE_URL=t.ASSETS_BASE_URL}},4357:t=>{function e(t,e){const n=document.createElement("canvas");return n.width=t,n.height=e,{canvas:n,ctx:n.getContext("2d")}}t.exports={resizeImage:async function(t,n,r,a){if(!(t&&n&&r&&a))throw new Error("Missing required parameters");const i=await async function(t){const e=new Image,n=URL.createObjectURL(t);try{return await new Promise((t,r)=>{e.onload=t,e.onerror=()=>r(new Error("Failed to load image")),e.src=n}),e}finally{URL.revokeObjectURL(n)}}(t),o=a/r,{width:u,height:c}=function(t,e,n,r){const a=t[32][0]-t[0][0],i=.4*a;let o=a+2*i,u=(2*i+a)*r;return o=Math.min(o,e),o=Math.max(o,.3*e),u=Math.min(u,n),u=Math.max(u,.3*n),{width:o,height:u}}(n,i.width,i.height,o),{x:s,y:l}=function(t,e,n){const r=t[43][0],a=t.reduce((t,e)=>t+e[1],0)/t.length;return{x:r,y:Math.max(.5*e,Math.min(a,n-.5*e-1))}}(n,c,i.height),{startX:f,startY:d,endX:h,endY:v}=function(t,e,n,r,a,i){const o=Math.max(0,t-.5*n),u=Math.max(0,e-.5*r);return{startX:o,startY:u,endX:Math.min(a,o+n),endY:Math.min(i,u+r)}}(s,l,u,c,i.width,i.height),{canvas:_,ctx:g}=e(h-f,v-d);g.drawImage(i,f,d,_.width,_.height,0,0,_.width,_.height);const m=function(t,e,n,r,a){return t.map(t=>[(t[0]-e)/r,(t[1]-n)/a])}(n,f,d,_.width,_.height),p=Math.min(a/_.height,r/_.width),y=Math.round(_.width*p),w=Math.round(_.height*p),b=(r-y)/2,E=(a-w)/2,{canvas:S,ctx:A}=e(r,a);A.fillStyle="white",A.fillRect(0,0,r,a),A.drawImage(_,0,0,_.width,_.height,b,E,y,w),m.forEach(t=>{t[0]=t[0]*y+b,t[1]=t[1]*w+E});const C=function(t,e,n){return t[0][0]<=0||t[0][0]<0||t[32][0]>e||t[16][1]>n||t[110][1]<0?1:0}(m,r,a);return{image:await new Promise(t=>{S.toBlob(t,"image/png")}),imageData:A.getImageData(0,0,r,a),landmarks:m,status:C}}}},9392:t=>{var e,n=(e="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0,function(t){var n,r;(t=t||{})||(t=void 0!==t?t:{}),t.ready=new Promise(function(t,e){n=t,r=e});var a,i={};for(a in t)t.hasOwnProperty(a)&&(i[a]=t[a]);var o=[],u="./this.program",c="";"undefined"!=typeof document&&document.currentScript&&(c=document.currentScript.src),e&&(c=e),c=0!==c.indexOf("blob:")?c.substr(0,c.lastIndexOf("/")+1):"";var s,l,f=t.print||console.log.bind(console),d=t.printErr||console.warn.bind(console);for(a in i)i.hasOwnProperty(a)&&(t[a]=i[a]);i=null,t.arguments&&(o=t.arguments),t.thisProgram&&(u=t.thisProgram),t.quit&&t.quit,t.wasmBinary&&(s=t.wasmBinary),t.noExitRuntime,"object"!=typeof WebAssembly&&q("no native wasm support detected");var h=!1,v="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function _(t,e,n){for(var r=e+n,a=e;t[a]&&!(a>=r);)++a;if(a-e>16&&t.subarray&&v)return v.decode(t.subarray(e,a));for(var i="";e<a;){var o=t[e++];if(128&o){var u=63&t[e++];if(192!=(224&o)){var c=63&t[e++];if((o=224==(240&o)?(15&o)<<12|u<<6|c:(7&o)<<18|u<<12|c<<6|63&t[e++])<65536)i+=String.fromCharCode(o);else{var s=o-65536;i+=String.fromCharCode(55296|s>>10,56320|1023&s)}}else i+=String.fromCharCode((31&o)<<6|u)}else i+=String.fromCharCode(o)}return i}function g(t,e){return t?_(b,t,e):""}function m(t,e,n,r){if(!(r>0))return 0;for(var a=n,i=n+r-1,o=0;o<t.length;++o){var u=t.charCodeAt(o);if(u>=55296&&u<=57343&&(u=65536+((1023&u)<<10)|1023&t.charCodeAt(++o)),u<=127){if(n>=i)break;e[n++]=u}else if(u<=2047){if(n+1>=i)break;e[n++]=192|u>>6,e[n++]=128|63&u}else if(u<=65535){if(n+2>=i)break;e[n++]=224|u>>12,e[n++]=128|u>>6&63,e[n++]=128|63&u}else{if(n+3>=i)break;e[n++]=240|u>>18,e[n++]=128|u>>12&63,e[n++]=128|u>>6&63,e[n++]=128|63&u}}return e[n]=0,n-a}function p(t){for(var e=0,n=0;n<t.length;++n){var r=t.charCodeAt(n);r>=55296&&r<=57343&&(r=65536+((1023&r)<<10)|1023&t.charCodeAt(++n)),r<=127?++e:e+=r<=2047?2:r<=65535?3:4}return e}var y,w,b,E,S,A,C,T,I,F="undefined"!=typeof TextDecoder?new TextDecoder("utf-16le"):void 0;function O(t,e){for(var n=t,r=n>>1,a=r+e/2;!(r>=a)&&S[r];)++r;if((n=r<<1)-t>32&&F)return F.decode(b.subarray(t,n));for(var i="",o=0;!(o>=e/2);++o){var u=E[t+2*o>>1];if(0==u)break;i+=String.fromCharCode(u)}return i}function D(t,e,n){if(void 0===n&&(n=2147483647),n<2)return 0;for(var r=e,a=(n-=2)<2*t.length?n/2:t.length,i=0;i<a;++i){var o=t.charCodeAt(i);E[e>>1]=o,e+=2}return E[e>>1]=0,e-r}function P(t){return 2*t.length}function R(t,e){for(var n=0,r="";!(n>=e/4);){var a=A[t+4*n>>2];if(0==a)break;if(++n,a>=65536){var i=a-65536;r+=String.fromCharCode(55296|i>>10,56320|1023&i)}else r+=String.fromCharCode(a)}return r}function k(t,e,n){if(void 0===n&&(n=2147483647),n<4)return 0;for(var r=e,a=r+n-4,i=0;i<t.length;++i){var o=t.charCodeAt(i);if(o>=55296&&o<=57343&&(o=65536+((1023&o)<<10)|1023&t.charCodeAt(++i)),A[e>>2]=o,(e+=4)+4>a)break}return A[e>>2]=0,e-r}function x(t){for(var e=0,n=0;n<t.length;++n){var r=t.charCodeAt(n);r>=55296&&r<=57343&&++n,e+=4}return e}function M(t,e){return t%e>0&&(t+=e-t%e),t}function U(e){y=e,t.HEAP8=w=new Int8Array(e),t.HEAP16=E=new Int16Array(e),t.HEAP32=A=new Int32Array(e),t.HEAPU8=b=new Uint8Array(e),t.HEAPU16=S=new Uint16Array(e),t.HEAPU32=C=new Uint32Array(e),t.HEAPF32=T=new Float32Array(e),t.HEAPF64=I=new Float64Array(e)}t.INITIAL_MEMORY;var L,N=[],W=[],j=[],Y=[];function G(t){N.unshift(t)}function B(t){Y.unshift(t)}W.push({func:function(){Wt()}});var z=0,H=null,V=null;function q(e){t.onAbort&&t.onAbort(e),d(e+=""),h=!0,e="abort("+e+"). Build with -s ASSERTIONS=1 for more info.";var n=new WebAssembly.RuntimeError(e);throw r(n),n}function $(t){return e=t,n="data:application/octet-stream;base64,",String.prototype.startsWith?e.startsWith(n):0===e.indexOf(n);var e,n}t.preloadedImages={},t.preloadedAudios={};var X,K="orbo-smart-capture.wasm";function J(t){try{if(t==K&&s)return new Uint8Array(s);throw"both async and sync fetching of the wasm failed"}catch(t){q(t)}}function Z(e){for(;e.length>0;){var n=e.shift();if("function"!=typeof n){var r=n.func;"number"==typeof r?void 0===n.arg?L.get(r)():L.get(r)(n.arg):r(void 0===n.arg?null:n.arg)}else n(t)}}$(K)||(X=K,K=t.locateFile?t.locateFile(X,c):c+X);function Q(t){this.excPtr=t,this.ptr=t-16,this.set_type=function(t){A[this.ptr+8>>2]=t},this.get_type=function(){return A[this.ptr+8>>2]},this.set_destructor=function(t){A[this.ptr+0>>2]=t},this.get_destructor=function(){return A[this.ptr+0>>2]},this.set_refcount=function(t){A[this.ptr+4>>2]=t},this.set_caught=function(t){t=t?1:0,w[this.ptr+12|0]=t},this.get_caught=function(){return 0!=w[this.ptr+12|0]},this.set_rethrown=function(t){t=t?1:0,w[this.ptr+13|0]=t},this.get_rethrown=function(){return 0!=w[this.ptr+13|0]},this.init=function(t,e){this.set_type(t),this.set_destructor(e),this.set_refcount(0),this.set_caught(!1),this.set_rethrown(!1)},this.add_ref=function(){var t=A[this.ptr+4>>2];A[this.ptr+4>>2]=t+1},this.release_ref=function(){var t=A[this.ptr+4>>2];return A[this.ptr+4>>2]=t-1,1===t}}var tt={};function et(t){for(;t.length;){var e=t.pop();t.pop()(e)}}function nt(t){return this.fromWireType(C[t>>2])}var rt={},at={},it={};function ot(t){if(void 0===t)return"_unknown";var e=(t=t.replace(/[^a-zA-Z0-9_]/g,"$")).charCodeAt(0);return e>=48&&e<=57?"_"+t:t}function ut(t,e){return t=ot(t),new Function("body","return function "+t+'() {\n    "use strict";    return body.apply(this, arguments);\n};\n')(e)}function ct(t,e){var n=ut(e,function(t){this.name=e,this.message=t;var n=new Error(t).stack;void 0!==n&&(this.stack=this.toString()+"\n"+n.replace(/^Error(:[^\n]*)?\n/,""))});return n.prototype=Object.create(t.prototype),n.prototype.constructor=n,n.prototype.toString=function(){return void 0===this.message?this.name:this.name+": "+this.message},n}var st=void 0;function lt(t){throw new st(t)}function ft(t,e,n){function r(e){var r=n(e);r.length!==t.length&&lt("Mismatched type converter count");for(var a=0;a<t.length;++a)mt(t[a],r[a])}t.forEach(function(t){it[t]=e});var a=new Array(e.length),i=[],o=0;e.forEach(function(t,e){at.hasOwnProperty(t)?a[e]=at[t]:(i.push(t),rt.hasOwnProperty(t)||(rt[t]=[]),rt[t].push(function(){a[e]=at[t],++o===i.length&&r(a)}))}),0===i.length&&r(a)}function dt(t){switch(t){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+t)}}var ht=void 0;function vt(t){for(var e="",n=t;b[n];)e+=ht[b[n++]];return e}var _t=void 0;function gt(t){throw new _t(t)}function mt(t,e,n){if(n=n||{},!("argPackAdvance"in e))throw new TypeError("registerType registeredInstance requires argPackAdvance");var r=e.name;if(t||gt('type "'+r+'" must have a positive integer typeid pointer'),at.hasOwnProperty(t)){if(n.ignoreDuplicateRegistrations)return;gt("Cannot register type '"+r+"' twice")}if(at[t]=e,delete it[t],rt.hasOwnProperty(t)){var a=rt[t];delete rt[t],a.forEach(function(t){t()})}}var pt=[],yt=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function wt(t){t>4&&0===--yt[t].refcount&&(yt[t]=void 0,pt.push(t))}function bt(t){switch(t){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:var e=pt.length?pt.pop():yt.length;return yt[e]={refcount:1,value:t},e}}function Et(t){if(null===t)return"null";var e=typeof t;return"object"===e||"array"===e||"function"===e?t.toString():""+t}function St(t,e){switch(e){case 2:return function(t){return this.fromWireType(T[t>>2])};case 3:return function(t){return this.fromWireType(I[t>>3])};default:throw new TypeError("Unknown float type: "+t)}}function At(e,n){var r,a,i,o=-1!=(e=vt(e)).indexOf("j")?(r=e,a=n,i=[],function(){i.length=arguments.length;for(var e=0;e<arguments.length;e++)i[e]=arguments[e];return function(e,n,r){return-1!=e.indexOf("j")?function(e,n,r){var a=t["dynCall_"+e];return r&&r.length?a.apply(null,[n].concat(r)):a.call(null,n)}(e,n,r):L.get(n).apply(null,r)}(r,a,i)}):L.get(n);return"function"!=typeof o&&gt("unknown function pointer with signature "+e+": "+n),o}var Ct=void 0;function Tt(t){var e=Gt(t),n=vt(e);return Yt(e),n}function It(t,e,n){switch(e){case 0:return n?function(t){return w[t]}:function(t){return b[t]};case 1:return n?function(t){return E[t>>1]}:function(t){return S[t>>1]};case 2:return n?function(t){return A[t>>2]}:function(t){return C[t>>2]};default:throw new TypeError("Unknown integer type: "+t)}}function Ft(t){try{return l.grow(t-y.byteLength+65535>>>16),U(l.buffer),1}catch(t){}}var Ot={};function Dt(){if(!Dt.strings){var t={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:u||"./this.program"};for(var e in Ot)t[e]=Ot[e];var n=[];for(var e in t)n.push(e+"="+t[e]);Dt.strings=n}return Dt.strings}var Pt={mappings:{},buffers:[null,[],[]],printChar:function(t,e){var n=Pt.buffers[t];0===e||10===e?((1===t?f:d)(_(n,0)),n.length=0):n.push(e)},varargs:void 0,get:function(){return Pt.varargs+=4,A[Pt.varargs-4>>2]},getStr:function(t){return g(t)},get64:function(t,e){return t}};function Rt(t){return t%4==0&&(t%100!=0||t%400==0)}function kt(t,e){for(var n=0,r=0;r<=e;n+=t[r++]);return n}var xt=[31,29,31,30,31,30,31,31,30,31,30,31],Mt=[31,28,31,30,31,30,31,31,30,31,30,31];function Ut(t,e){for(var n=new Date(t.getTime());e>0;){var r=Rt(n.getFullYear()),a=n.getMonth(),i=(r?xt:Mt)[a];if(!(e>i-n.getDate()))return n.setDate(n.getDate()+e),n;e-=i-n.getDate()+1,n.setDate(1),a<11?n.setMonth(a+1):(n.setMonth(0),n.setFullYear(n.getFullYear()+1))}return n}st=t.InternalError=ct(Error,"InternalError"),function(){for(var t=new Array(256),e=0;e<256;++e)t[e]=String.fromCharCode(e);ht=t}(),_t=t.BindingError=ct(Error,"BindingError"),t.count_emval_handles=function(){for(var t=0,e=5;e<yt.length;++e)void 0!==yt[e]&&++t;return t},t.get_first_emval=function(){for(var t=5;t<yt.length;++t)if(void 0!==yt[t])return yt[t];return null},Ct=t.UnboundTypeError=ct(Error,"UnboundTypeError");var Lt,Nt={f:function(t){return jt(t+16)+16},e:function(t,e,n){throw new Q(t).init(e,n),t},p:function(t){var e=tt[t];delete tt[t];var n=e.rawConstructor,r=e.rawDestructor,a=e.fields;ft([t],a.map(function(t){return t.getterReturnType}).concat(a.map(function(t){return t.setterArgumentType})),function(t){var i={};return a.forEach(function(e,n){var r=e.fieldName,o=t[n],u=e.getter,c=e.getterContext,s=t[n+a.length],l=e.setter,f=e.setterContext;i[r]={read:function(t){return o.fromWireType(u(c,t))},write:function(t,e){var n=[];l(f,t,s.toWireType(n,e)),et(n)}}}),[{name:e.name,fromWireType:function(t){var e={};for(var n in i)e[n]=i[n].read(t);return r(t),e},toWireType:function(t,e){for(var a in i)if(!(a in e))throw new TypeError('Missing field:  "'+a+'"');var o=n();for(a in i)i[a].write(o,e[a]);return null!==t&&t.push(r,o),o},argPackAdvance:8,readValueFromPointer:nt,destructorFunction:r}]})},A:function(t,e,n,r,a){var i=dt(n);mt(t,{name:e=vt(e),fromWireType:function(t){return!!t},toWireType:function(t,e){return e?r:a},argPackAdvance:8,readValueFromPointer:function(t){var r;if(1===n)r=w;else if(2===n)r=E;else{if(4!==n)throw new TypeError("Unknown boolean type size: "+e);r=A}return this.fromWireType(r[t>>i])},destructorFunction:null})},z:function(t,e){mt(t,{name:e=vt(e),fromWireType:function(t){var e=yt[t].value;return wt(t),e},toWireType:function(t,e){return bt(e)},argPackAdvance:8,readValueFromPointer:nt,destructorFunction:null})},j:function(t,e,n){var r=dt(n);mt(t,{name:e=vt(e),fromWireType:function(t){return t},toWireType:function(t,e){if("number"!=typeof e&&"boolean"!=typeof e)throw new TypeError('Cannot convert "'+Et(e)+'" to '+this.name);return e},argPackAdvance:8,readValueFromPointer:St(e,r),destructorFunction:null})},l:function(e,n,r,a,i,o){var u=function(t,e){for(var n=[],r=0;r<t;r++)n.push(A[(e>>2)+r]);return n}(n,r);e=vt(e),i=At(a,i),function(e,n,r){t.hasOwnProperty(e)?((void 0===r||void 0!==t[e].overloadTable&&void 0!==t[e].overloadTable[r])&&gt("Cannot register public name '"+e+"' twice"),function(t,e,n){if(void 0===t[e].overloadTable){var r=t[e];t[e]=function(){return t[e].overloadTable.hasOwnProperty(arguments.length)||gt("Function '"+n+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+t[e].overloadTable+")!"),t[e].overloadTable[arguments.length].apply(this,arguments)},t[e].overloadTable=[],t[e].overloadTable[r.argCount]=r}}(t,e,e),t.hasOwnProperty(r)&&gt("Cannot register multiple overloads of a function with the same number of arguments ("+r+")!"),t[e].overloadTable[r]=n):(t[e]=n,void 0!==r&&(t[e].numArguments=r))}(e,function(){!function(t,e){var n=[],r={};throw e.forEach(function t(e){r[e]||at[e]||(it[e]?it[e].forEach(t):(n.push(e),r[e]=!0))}),new Ct(t+": "+n.map(Tt).join([", "]))}("Cannot call "+e+" due to unbound types",u)},n-1),ft([],u,function(r){var a=[r[0],null].concat(r.slice(1));return function(e,n,r){t.hasOwnProperty(e)||lt("Replacing nonexistant public symbol"),void 0!==t[e].overloadTable&&void 0!==r?t[e].overloadTable[r]=n:(t[e]=n,t[e].argCount=r)}(e,function(t,e,n,r,a){var i=e.length;i<2&&gt("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var o=null!==e[1]&&null!==n,u=!1,c=1;c<e.length;++c)if(null!==e[c]&&void 0===e[c].destructorFunction){u=!0;break}var s="void"!==e[0].name,l="",f="";for(c=0;c<i-2;++c)l+=(0!==c?", ":"")+"arg"+c,f+=(0!==c?", ":"")+"arg"+c+"Wired";var d="return function "+ot(t)+"("+l+") {\nif (arguments.length !== "+(i-2)+") {\nthrowBindingError('function "+t+" called with ' + arguments.length + ' arguments, expected "+(i-2)+" args!');\n}\n";u&&(d+="var destructors = [];\n");var h=u?"destructors":"null",v=["throwBindingError","invoker","fn","runDestructors","retType","classParam"],_=[gt,r,a,et,e[0],e[1]];for(o&&(d+="var thisWired = classParam.toWireType("+h+", this);\n"),c=0;c<i-2;++c)d+="var arg"+c+"Wired = argType"+c+".toWireType("+h+", arg"+c+"); // "+e[c+2].name+"\n",v.push("argType"+c),_.push(e[c+2]);if(o&&(f="thisWired"+(f.length>0?", ":"")+f),d+=(s?"var rv = ":"")+"invoker(fn"+(f.length>0?", ":"")+f+");\n",u)d+="runDestructors(destructors);\n";else for(c=o?1:2;c<e.length;++c){var g=1===c?"thisWired":"arg"+(c-2)+"Wired";null!==e[c].destructorFunction&&(d+=g+"_dtor("+g+"); // "+e[c].name+"\n",v.push(g+"_dtor"),_.push(e[c].destructorFunction))}return s&&(d+="var ret = retType.fromWireType(rv);\nreturn ret;\n"),d+="}\n",v.push(d),function(t,e){if(!(t instanceof Function))throw new TypeError("new_ called with constructor type "+typeof t+" which is not a function");var n=ut(t.name||"unknownFunctionName",function(){});n.prototype=t.prototype;var r=new n,a=t.apply(r,e);return a instanceof Object?a:r}(Function,v).apply(null,_)}(e,a,null,i,o),n-1),[]})},b:function(t,e,n,r,a){e=vt(e),-1===a&&(a=4294967295);var i=dt(n),o=function(t){return t};if(0===r){var u=32-8*n;o=function(t){return t<<u>>>u}}var c=-1!=e.indexOf("unsigned");mt(t,{name:e,fromWireType:o,toWireType:function(t,n){if("number"!=typeof n&&"boolean"!=typeof n)throw new TypeError('Cannot convert "'+Et(n)+'" to '+this.name);if(n<r||n>a)throw new TypeError('Passing a number "'+Et(n)+'" from JS side to C/C++ side to an argument of type "'+e+'", which is outside the valid range ['+r+", "+a+"]!");return c?n>>>0:0|n},argPackAdvance:8,readValueFromPointer:It(e,i,0!==r),destructorFunction:null})},a:function(t,e,n){var r=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array][e];function a(t){var e=C,n=e[t>>=2],a=e[t+1];return new r(y,a,n)}mt(t,{name:n=vt(n),fromWireType:a,argPackAdvance:8,readValueFromPointer:a},{ignoreDuplicateRegistrations:!0})},k:function(t,e){var n="std::string"===(e=vt(e));mt(t,{name:e,fromWireType:function(t){var e,r=C[t>>2];if(n)for(var a=t+4,i=0;i<=r;++i){var o=t+4+i;if(i==r||0==b[o]){var u=g(a,o-a);void 0===e?e=u:(e+=String.fromCharCode(0),e+=u),a=o+1}}else{var c=new Array(r);for(i=0;i<r;++i)c[i]=String.fromCharCode(b[t+4+i]);e=c.join("")}return Yt(t),e},toWireType:function(t,e){e instanceof ArrayBuffer&&(e=new Uint8Array(e));var r="string"==typeof e;r||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int8Array||gt("Cannot pass non-string to std::string");var a=(n&&r?function(){return p(e)}:function(){return e.length})(),i=jt(4+a+1);if(C[i>>2]=a,n&&r)m(e,b,i+4,a+1);else if(r)for(var o=0;o<a;++o){var u=e.charCodeAt(o);u>255&&(Yt(i),gt("String has UTF-16 code units that do not fit in 8 bits")),b[i+4+o]=u}else for(o=0;o<a;++o)b[i+4+o]=e[o];return null!==t&&t.push(Yt,i),i},argPackAdvance:8,readValueFromPointer:nt,destructorFunction:function(t){Yt(t)}})},g:function(t,e,n){var r,a,i,o,u;n=vt(n),2===e?(r=O,a=D,o=P,i=function(){return S},u=1):4===e&&(r=R,a=k,o=x,i=function(){return C},u=2),mt(t,{name:n,fromWireType:function(t){for(var n,a=C[t>>2],o=i(),c=t+4,s=0;s<=a;++s){var l=t+4+s*e;if(s==a||0==o[l>>u]){var f=r(c,l-c);void 0===n?n=f:(n+=String.fromCharCode(0),n+=f),c=l+e}}return Yt(t),n},toWireType:function(t,r){"string"!=typeof r&&gt("Cannot pass non-string to C++ string type "+n);var i=o(r),c=jt(4+i+e);return C[c>>2]=i>>u,a(r,c+4,i+e),null!==t&&t.push(Yt,c),c},argPackAdvance:8,readValueFromPointer:nt,destructorFunction:function(t){Yt(t)}})},v:function(t,e,n,r,a,i){tt[t]={name:vt(e),rawConstructor:At(n,r),rawDestructor:At(a,i),fields:[]}},d:function(t,e,n,r,a,i,o,u,c,s){tt[t].fields.push({fieldName:vt(e),getterReturnType:n,getter:At(r,a),getterContext:i,setterArgumentType:o,setter:At(u,c),setterContext:s})},m:function(t,e){mt(t,{isVoid:!0,name:e=vt(e),argPackAdvance:0,fromWireType:function(){},toWireType:function(t,e){}})},n:wt,o:function(t){t>4&&(yt[t].refcount+=1)},B:function(t,e){var n,r;return void 0===(r=at[n=t])&&gt("_emval_take_value has unknown type "+Tt(n)),bt((t=r).readValueFromPointer(e))},i:function(){q()},r:function(t,e,n){b.copyWithin(t,e,e+n)},c:function(t){var e=b.length,n=2147483648;if(t>n)return!1;for(var r=1;r<=4;r*=2){var a=e*(1+.2/r);if(a=Math.min(a,t+100663296),Ft(Math.min(n,M(Math.max(t,a),65536))))return!0}return!1},t:function(t,e){var n=0;return Dt().forEach(function(r,a){var i=e+n;A[t+4*a>>2]=i,function(t,e){for(var n=0;n<t.length;++n)w[0|e++]=t.charCodeAt(n);w[0|e]=0}(r,i),n+=r.length+1}),0},u:function(t,e){var n=Dt();A[t>>2]=n.length;var r=0;return n.forEach(function(t){r+=t.length+1}),A[e>>2]=r,0},y:function(t){return 0},w:function(t,e,n,r){var a=Pt.getStreamFromFD(t),i=Pt.doReadv(a,e,n);return A[r>>2]=i,0},q:function(t,e,n,r,a){},x:function(t,e,n,r){for(var a=0,i=0;i<n;i++){for(var o=A[e+8*i>>2],u=A[e+(8*i+4)>>2],c=0;c<u;c++)Pt.printChar(t,b[o+c]);a+=u}return A[r>>2]=a,0},h:function(t){},s:function(t,e,n,r){return function(t,e,n,r){var a=A[r+40>>2],i={tm_sec:A[r>>2],tm_min:A[r+4>>2],tm_hour:A[r+8>>2],tm_mday:A[r+12>>2],tm_mon:A[r+16>>2],tm_year:A[r+20>>2],tm_wday:A[r+24>>2],tm_yday:A[r+28>>2],tm_isdst:A[r+32>>2],tm_gmtoff:A[r+36>>2],tm_zone:a?g(a):""},o=g(n),u={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var c in u)o=o.replace(new RegExp(c,"g"),u[c]);var s=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],l=["January","February","March","April","May","June","July","August","September","October","November","December"];function f(t,e,n){for(var r="number"==typeof t?t.toString():t||"";r.length<e;)r=n[0]+r;return r}function d(t,e){return f(t,e,"0")}function h(t,e){function n(t){return t<0?-1:t>0?1:0}var r;return 0===(r=n(t.getFullYear()-e.getFullYear()))&&0===(r=n(t.getMonth()-e.getMonth()))&&(r=n(t.getDate()-e.getDate())),r}function v(t){switch(t.getDay()){case 0:return new Date(t.getFullYear()-1,11,29);case 1:return t;case 2:return new Date(t.getFullYear(),0,3);case 3:return new Date(t.getFullYear(),0,2);case 4:return new Date(t.getFullYear(),0,1);case 5:return new Date(t.getFullYear()-1,11,31);case 6:return new Date(t.getFullYear()-1,11,30)}}function _(t){var e=Ut(new Date(t.tm_year+1900,0,1),t.tm_yday),n=new Date(e.getFullYear(),0,4),r=new Date(e.getFullYear()+1,0,4),a=v(n),i=v(r);return h(a,e)<=0?h(i,e)<=0?e.getFullYear()+1:e.getFullYear():e.getFullYear()-1}var y={"%a":function(t){return s[t.tm_wday].substring(0,3)},"%A":function(t){return s[t.tm_wday]},"%b":function(t){return l[t.tm_mon].substring(0,3)},"%B":function(t){return l[t.tm_mon]},"%C":function(t){return d((t.tm_year+1900)/100|0,2)},"%d":function(t){return d(t.tm_mday,2)},"%e":function(t){return f(t.tm_mday,2," ")},"%g":function(t){return _(t).toString().substring(2)},"%G":function(t){return _(t)},"%H":function(t){return d(t.tm_hour,2)},"%I":function(t){var e=t.tm_hour;return 0==e?e=12:e>12&&(e-=12),d(e,2)},"%j":function(t){return d(t.tm_mday+kt(Rt(t.tm_year+1900)?xt:Mt,t.tm_mon-1),3)},"%m":function(t){return d(t.tm_mon+1,2)},"%M":function(t){return d(t.tm_min,2)},"%n":function(){return"\n"},"%p":function(t){return t.tm_hour>=0&&t.tm_hour<12?"AM":"PM"},"%S":function(t){return d(t.tm_sec,2)},"%t":function(){return"\t"},"%u":function(t){return t.tm_wday||7},"%U":function(t){var e=new Date(t.tm_year+1900,0,1),n=0===e.getDay()?e:Ut(e,7-e.getDay()),r=new Date(t.tm_year+1900,t.tm_mon,t.tm_mday);if(h(n,r)<0){var a=kt(Rt(r.getFullYear())?xt:Mt,r.getMonth()-1)-31,i=31-n.getDate()+a+r.getDate();return d(Math.ceil(i/7),2)}return 0===h(n,e)?"01":"00"},"%V":function(t){var e,n=new Date(t.tm_year+1900,0,4),r=new Date(t.tm_year+1901,0,4),a=v(n),i=v(r),o=Ut(new Date(t.tm_year+1900,0,1),t.tm_yday);return h(o,a)<0?"53":h(i,o)<=0?"01":(e=a.getFullYear()<t.tm_year+1900?t.tm_yday+32-a.getDate():t.tm_yday+1-a.getDate(),d(Math.ceil(e/7),2))},"%w":function(t){return t.tm_wday},"%W":function(t){var e=new Date(t.tm_year,0,1),n=1===e.getDay()?e:Ut(e,0===e.getDay()?1:7-e.getDay()+1),r=new Date(t.tm_year+1900,t.tm_mon,t.tm_mday);if(h(n,r)<0){var a=kt(Rt(r.getFullYear())?xt:Mt,r.getMonth()-1)-31,i=31-n.getDate()+a+r.getDate();return d(Math.ceil(i/7),2)}return 0===h(n,e)?"01":"00"},"%y":function(t){return(t.tm_year+1900).toString().substring(2)},"%Y":function(t){return t.tm_year+1900},"%z":function(t){var e=t.tm_gmtoff,n=e>=0;return e=(e=Math.abs(e)/60)/60*100+e%60,(n?"+":"-")+String("0000"+e).slice(-4)},"%Z":function(t){return t.tm_zone},"%%":function(){return"%"}};for(var c in y)o.indexOf(c)>=0&&(o=o.replace(new RegExp(c,"g"),y[c](i)));var b,E,S,C=(E=p(b=o)+1,m(b,S=new Array(E),0,S.length),S);return C.length>e?0:(function(t,e){w.set(t,e)}(C,t),C.length-1)}(t,e,n,r)}},Wt=(function(){var e={a:Nt};function n(e,n){var r=e.exports;t.asm=r,U((l=t.asm.C).buffer),L=t.asm.E,function(){if(z--,t.monitorRunDependencies&&t.monitorRunDependencies(z),0==z&&(null!==H&&(clearInterval(H),H=null),V)){var e=V;V=null,e()}}()}function a(t){n(t.instance)}function i(t){return(s||"function"!=typeof fetch?Promise.resolve().then(function(){return J(K)}):fetch(K,{credentials:"same-origin"}).then(function(t){if(!t.ok)throw"failed to load wasm binary file at '"+K+"'";return t.arrayBuffer()}).catch(function(){return J(K)})).then(function(t){return WebAssembly.instantiate(t,e)}).then(t,function(t){d("failed to asynchronously prepare wasm: "+t),q(t)})}if(z++,t.monitorRunDependencies&&t.monitorRunDependencies(z),t.instantiateWasm)try{return t.instantiateWasm(e,n)}catch(t){return d("Module.instantiateWasm callback failed with error: "+t),!1}(s||"function"!=typeof WebAssembly.instantiateStreaming||$(K)||"function"!=typeof fetch?i(a):fetch(K,{credentials:"same-origin"}).then(function(t){return WebAssembly.instantiateStreaming(t,e).then(a,function(t){return d("wasm streaming compile failed: "+t),d("falling back to ArrayBuffer instantiation"),i(a)})})).catch(r)}(),t.___wasm_call_ctors=function(){return(Wt=t.___wasm_call_ctors=t.asm.D).apply(null,arguments)}),jt=t._malloc=function(){return(jt=t._malloc=t.asm.F).apply(null,arguments)},Yt=t._free=function(){return(Yt=t._free=t.asm.G).apply(null,arguments)},Gt=t.___getTypeName=function(){return(Gt=t.___getTypeName=t.asm.H).apply(null,arguments)};function Bt(e){function r(){Lt||(Lt=!0,t.calledRun=!0,h||(Z(W),Z(j),n(t),t.onRuntimeInitialized&&t.onRuntimeInitialized(),function(){if(t.postRun)for("function"==typeof t.postRun&&(t.postRun=[t.postRun]);t.postRun.length;)B(t.postRun.shift());Z(Y)}()))}e=e||o,z>0||(function(){if(t.preRun)for("function"==typeof t.preRun&&(t.preRun=[t.preRun]);t.preRun.length;)G(t.preRun.shift());Z(N)}(),z>0||(t.setStatus?(t.setStatus("Running..."),setTimeout(function(){setTimeout(function(){t.setStatus("")},1),r()},1)):r()))}if(t.___embind_register_native_and_builtin_types=function(){return(t.___embind_register_native_and_builtin_types=t.asm.I).apply(null,arguments)},t.dynCall_ji=function(){return(t.dynCall_ji=t.asm.J).apply(null,arguments)},t.dynCall_viijii=function(){return(t.dynCall_viijii=t.asm.K).apply(null,arguments)},t.dynCall_jiji=function(){return(t.dynCall_jiji=t.asm.L).apply(null,arguments)},t.dynCall_iiiiiijj=function(){return(t.dynCall_iiiiiijj=t.asm.M).apply(null,arguments)},t.dynCall_iiiiij=function(){return(t.dynCall_iiiiij=t.asm.N).apply(null,arguments)},t.dynCall_iiiiijj=function(){return(t.dynCall_iiiiijj=t.asm.O).apply(null,arguments)},V=function t(){Lt||Bt(),Lt||(V=t)},t.run=Bt,t.preInit)for("function"==typeof t.preInit&&(t.preInit=[t.preInit]);t.preInit.length>0;)t.preInit.pop()();return Bt(),t.ready});t.exports=n}}]);