/*! For license information please see 885.orbo-smart-capture.js.LICENSE.txt */
(self.webpackChunkOrboSmartCapture=self.webpackChunkOrboSmartCapture||[]).push([[885],{3857:()=>{},5817:()=>{},6318:(t,n,r)=>{"use strict";r.r(n),r.d(n,{BlazeFaceModel:()=>h,load:()=>d});var e=r(6125),i=r(7354);function o(t,n,r,e){return new(r||(r=Promise))(function(i,o){function a(t){try{u(e.next(t))}catch(t){o(t)}}function s(t){try{u(e.throw(t))}catch(t){o(t)}}function u(t){var n;t.done?i(t.value):(n=t.value,n instanceof r?n:new r(function(t){t(n)})).then(a,s)}u((e=e.apply(t,n||[])).next())})}function a(t,n){var r,e,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,e&&(i=2&o[0]?e.return:o[0]?e.throw||((i=e.return)&&i.call(e),0):e.next)&&!(i=i.call(e,o[1])).done)return i;switch(e=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,e=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=n.call(t,a)}catch(t){o=[6,t],e=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var s=function(t){return{startEndTensor:t,startPoint:(0,e.dik)(t,[0,0],[-1,2]),endPoint:(0,e.dik)(t,[0,2],[-1,2])}},u={strides:[8,16],anchors:[2,6]};function c(t,n){var r,i,o;if(t.topLeft instanceof e.qYS&&t.bottomRight instanceof e.qYS){var a=(0,e.DZQ)(function(){return[(0,e.xWs)([(0,e.dik)((0,e.jbE)(n-1,t.topLeft),0,1),(0,e.dik)(t.topLeft,1,1)]),(0,e.xWs)([(0,e.jbE)(n-1,(0,e.dik)(t.bottomRight,0,1)),(0,e.dik)(t.bottomRight,1,1)])]});r=a[0],i=a[1],null!=t.landmarks&&(o=(0,e.DZQ)(function(){var r=(0,e.jbE)((0,e.tGX)([n-1,0]),t.landmarks),i=(0,e.tGX)([1,-1]);return(0,e.lKK)(r,i)}))}else{var s=t.topLeft,u=s[0],c=s[1],l=t.bottomRight,h=l[0],f=l[1];r=[n-1-u,c],i=[n-1-h,f],null!=t.landmarks&&(o=t.landmarks.map(function(t){return[n-1-t[0],t[1]]}))}var d={topLeft:r,bottomRight:i};return null!=o&&(d.landmarks=o),null!=t.probability&&(d.probability=t.probability instanceof e.qYS?t.probability.clone():t.probability),d}function l(t,n){return(0,e.DZQ)(function(){var r;return r=t.hasOwnProperty("box")?t.box:t,(0,e.r2V)(function(t,n){var r=(0,e.lKK)(t.startPoint,n),i=(0,e.lKK)(t.endPoint,n),o=(0,e.RPU)([r,i],1);return s(o)}(r,n).startEndTensor)})}var h=function(){function t(t,n,r,i,o,a){this.blazeFaceModel=t,this.width=n,this.height=r,this.maxFaces=i,this.anchorsData=function(t,n,r){for(var e=[],i=0;i<r.strides.length;i++)for(var o=r.strides[i],a=Math.floor((n+o-1)/o),s=Math.floor((t+o-1)/o),u=r.anchors[i],c=0;c<a;c++)for(var l=o*(c+.5),h=0;h<s;h++)for(var f=o*(h+.5),d=0;d<u;d++)e.push([f,l]);return e}(n,r,u),this.anchors=(0,e.KtR)(this.anchorsData),this.inputSizeData=[n,r],this.inputSize=(0,e.tGX)([n,r]),this.iouThreshold=o,this.scoreThreshold=a}return t.prototype.getBoundingBoxes=function(t,n,r){return void 0===r&&(r=!0),o(this,void 0,void 0,function(){var i,u,c,l,h,f,d,p,b,v,m,y,k,w,g=this;return a(this,function(x){switch(x.label){case 0:return i=(0,e.DZQ)(function(){var n=e.Slp.resizeBilinear(t,[g.width,g.height]),r=(0,e.lKK)((0,e.jbE)((0,e.y4m)(n,255),.5),2),i=g.blazeFaceModel.predict(r),o=(0,e.r2V)(i),a=function(t,n,r){var i=(0,e.dik)(t,[0,1],[-1,2]),o=(0,e.WQq)(i,n),a=(0,e.dik)(t,[0,3],[-1,2]),s=(0,e.y4m)(a,r),u=(0,e.y4m)(o,r),c=(0,e.y4m)(s,2),l=(0,e.jbE)(u,c),h=(0,e.WQq)(u,c),f=(0,e.lKK)(l,r),d=(0,e.lKK)(h,r);return(0,e.RPU)([f,d],1)}(o,g.anchors,g.inputSize),s=(0,e.dik)(o,[0,0],[-1,1]);return[o,a,(0,e.r2V)((0,e.ry7)(s))]}),u=i[0],c=i[1],l=i[2],h=console.warn,console.warn=function(){},f=e.Slp.nonMaxSuppression(c,l,this.maxFaces,this.iouThreshold,this.scoreThreshold),console.warn=h,[4,f.array()];case 1:return d=x.sent(),f.dispose(),p=d.map(function(t){return(0,e.dik)(c,[t,0],[1,-1])}),n?[3,3]:[4,Promise.all(p.map(function(t){return o(g,void 0,void 0,function(){var n;return a(this,function(r){switch(r.label){case 0:return[4,t.array()];case 1:return n=r.sent(),t.dispose(),[2,n]}})})}))];case 2:p=x.sent(),x.label=3;case 3:for(b=t.shape[1],v=t.shape[2],m=n?(0,e.y4m)([v,b],this.inputSize):[v/this.inputSizeData[0],b/this.inputSizeData[1]],y=[],k=function(t){var i=p[t],o=(0,e.DZQ)(function(){var o=s(i instanceof e.qYS?i:(0,e.KtR)(i));if(!r)return o;var a,c=d[t];return a=n?(0,e.dik)(g.anchors,[c,0],[1,2]):g.anchorsData[c],{box:o,landmarks:(0,e.tQQ)((0,e.r2V)((0,e.dik)(u,[c,5],[1,-1])),[6,-1]),probability:(0,e.dik)(l,[c],[1]),anchor:a}});y.push(o)},w=0;w<p.length;w++)k(w);return c.dispose(),l.dispose(),u.dispose(),[2,{boxes:y,scaleFactor:m}]}})})},t.prototype.estimateFaces=function(t,n,r,i){return void 0===n&&(n=!1),void 0===r&&(r=!1),void 0===i&&(i=!0),o(this,void 0,void 0,function(){var s,u,h,f,d,p,b=this;return a(this,function(v){switch(v.label){case 0:return s=function(t){return t instanceof e.qYS?[t.shape[0],t.shape[1]]:[t.height,t.width]}(t),u=s[1],h=(0,e.DZQ)(function(){return t instanceof e.qYS||(t=e.TaL.fromPixels(t)),(0,e.UG6)((0,e.wgE)(t,"float32"),0)}),[4,this.getBoundingBoxes(h,n,i)];case 1:return f=v.sent(),d=f.boxes,p=f.scaleFactor,h.dispose(),n?[2,d.map(function(t){var n=l(t,p),o={topLeft:(0,e.dik)(n,[0],[2]),bottomRight:(0,e.dik)(n,[2],[2])};if(i){var a=t,s=a.landmarks,h=a.probability,f=a.anchor,d=(0,e.lKK)((0,e.WQq)(s,f),p);o.landmarks=d,o.probability=h}return r&&(o=c(o,u)),o})]:[2,Promise.all(d.map(function(t){return o(b,void 0,void 0,function(){var n,e,s,h,f,d,b,v,m,y,k,w=this;return a(this,function(g){switch(g.label){case 0:return n=l(t,p),i?[3,2]:[4,n.array()];case 1:return f=g.sent(),e={topLeft:f.slice(0,2),bottomRight:f.slice(2)},[3,4];case 2:return[4,Promise.all([t.landmarks,n,t.probability].map(function(t){return o(w,void 0,void 0,function(){return a(this,function(n){return[2,t.array()]})})}))];case 3:s=g.sent(),h=s[0],f=s[1],d=s[2],b=t.anchor,m=(v=p)[0],y=v[1],k=h.map(function(t){return[(t[0]+b[0])*m,(t[1]+b[1])*y]}),e={topLeft:f.slice(0,2),bottomRight:f.slice(2),landmarks:k,probability:d},function(t){t.startEndTensor.dispose(),t.startPoint.dispose(),t.endPoint.dispose()}(t.box),t.landmarks.dispose(),t.probability.dispose(),g.label=4;case 4:return n.dispose(),r&&(e=c(e,u)),[2,e]}})})}))]}})})},t}(),f="https://tfhub.dev/tensorflow/tfjs-model/blazeface/1/default/1";function d(t){var n=void 0===t?{}:t,r=n.maxFaces,e=void 0===r?10:r,s=n.inputWidth,u=void 0===s?128:s,c=n.inputHeight,l=void 0===c?128:c,d=n.iouThreshold,p=void 0===d?.3:d,b=n.scoreThreshold,v=void 0===b?.75:b,m=n.modelUrl;return o(this,void 0,void 0,function(){var t;return a(this,function(n){switch(n.label){case 0:return null==m?[3,2]:[4,(0,i.ox)(m)];case 1:return t=n.sent(),[3,4];case 2:return[4,(0,i.ox)(f,{fromTFHub:!0})];case 3:t=n.sent(),n.label=4;case 4:return[2,new h(t,u,l,e,p,v)]}})})}},8590:()=>{}}]);